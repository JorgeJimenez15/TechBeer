+n[r],c===e){if(s.all)continue;break}l=i.values[c],R(l)&&(o||t===0||vt(t)===vt(l))&&(t+=l)}return t}}function lr(i){const t=Object.keys(i),e=new Array(t.length);let s,n,o;for(s=0,n=t.length;s<n;++s)o=t[s],e[s]={x:o,y:i[o]};return e}function Fi(i,t){const e=i&&i.options.stacked;return e||e===void 0&&t.stack!==void 0}function hr(i,t,e){return`${i.id}.${t.id}.${e.stack||e.type}`}function dr(i){const{min:t,max:e,minDefined:s,maxDefined:n}=i.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:n?e:Number.POSITIVE_INFINITY}}function fr(i,t,e){const s=i[t]||(i[t]={});return s[e]||(s[e]={})}function Ri(i,t,e,s){for(const n of t.getMatchingVisibleMetas(s).reverse()){const o=i[n.index];if(e&&o>0||!e&&o<0)return n.index}return null}function zi(i,t){const{chart:e,_cachedMeta:s}=i,n=e._stacks||(e._stacks={}),{iScale:o,vScale:r,index:a}=s,c=o.axis,l=r.axis,h=hr(o,r,s),d=t.length;let f;for(let u=0;u<d;++u){const m=t[u],{[c]:p,[l]:g}=m,b=m._stacks||(m._stacks={});f=b[l]=fr(n,h,p),f[a]=g,f._top=Ri(f,r,!0,s.type),f._bottom=Ri(f,r,!1,s.type);const x=f._visualValues||(f._visualValues={});x[a]=g}}function Fe(i,t){const e=i.scales;return Object.keys(e).filter(s=>e[s].axis===t).shift()}function ur(i,t){return bt(i,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function gr(i,t,e){return bt(i,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function Lt(i,t){const e=i.controller.index,s=i.vScale&&i.vScale.axis;if(s){t=t||i._parsed;for(const n of t){const o=n._stacks;if(!o||o[s]===void 0||o[s][e]===void 0)return;delete o[s][e],o[s]._visualValues!==void 0&&o[s]._visualValues[e]!==void 0&&delete o[s]._visualValues[e]}}}const Re=i=>i==="reset"||i==="none",Ni=(i,t)=>t?i:Object.assign({},i),pr=(i,t,e)=>i&&!t.hidden&&t._stacked&&{keys:zs(e,!0),values:null};class Ht{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Fi(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Lt(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,s=this.getDataset(),n=(d,f,u,m)=>d==="x"?f:d==="r"?m:u,o=e.xAxisID=D(s.xAxisID,Fe(t,"x")),r=e.yAxisID=D(s.yAxisID,Fe(t,"y")),a=e.rAxisID=D(s.rAxisID,Fe(t,"r")),c=e.indexAxis,l=e.iAxisID=n(c,o,r,a),h=e.vAxisID=n(c,r,o,a);e.xScale=this.getScaleForId(o),e.yScale=this.getScaleForId(r),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(l),e.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&_i(this._data,this),t._stacked&&Lt(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),s=this._data;if(O(e))this._data=lr(e);else if(s!==e){if(s){_i(s,this);const n=this._cachedMeta;Lt(n),n._parsed=[]}e&&Object.isExtensible(e)&&$n(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,s=this.getDataset();let n=!1;this._dataCheck();const o=e._stacked;e._stacked=Fi(e.vScale,e),e.stack!==s.stack&&(n=!